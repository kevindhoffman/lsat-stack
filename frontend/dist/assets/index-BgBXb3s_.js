import{createClient as T}from"https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))c(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&c(l)}).observe(document,{childList:!0,subtree:!0});function o(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(t){if(t.ep)return;t.ep=!0;const s=o(t);fetch(t.href,s)}})();const u=T("https://reaubuunxfgyazrjuxmd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJlYXVidXVueGZneWF6cmp1eG1kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAwMzU2NzQsImV4cCI6MjA2NTYxMTY3NH0.4rI4xtkUrHQgGrhUadQDoD3jhlASKHrURVY6kLO1opI"),C=window.location.hostname==="localhost",E=C?"http://localhost:8000":"https://lsat-stack.onrender.com";let a=null,I=0,i=null,x=null;const r=document.getElementById("feedback-chart"),b=r.getContext("2d"),v=[],w={vocabulary:"assets/vocab.png",reading:"assets/reading.png",analytical:"assets/analytical.png",inference:"assets/inference.png",argumentation:"assets/balance.png",logic:"assets/logic.png"},m=document.getElementById("chart-wrapper");let g=!1;function A(e){i=e,x=Date.now(),document.getElementById("stimulus").innerText=e.stimulus;const n=document.getElementById("choices");n.innerHTML="";for(const[o,c]of Object.entries(e.choices)){const t=document.createElement("div");t.className="choice",t.innerText=`${o}: ${c}`,t.onclick=()=>S(o),n.appendChild(t)}document.getElementById("next-btn").classList.add("hidden"),["veritas","oak","strickland","calder"].forEach(o=>{const c=document.getElementById(o);c.classList.remove("correct","incorrect"),c.querySelector(".professor-quote").innerText="",g||c.classList.add("hidden")}),g||m.classList.add("hidden")}async function B(){if(!a&&I>=3){alert("Please sign in with Google to continue practicing.");return}const n=await(await fetch(`${E}/api/question`)).json();I++,A(n)}async function S(e){const n=(Date.now()-x)/1e3;m.classList.remove("hidden");const c=await(await fetch(`${E}/api/submit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question_id:i.question_id,answer:e,time_sec:n})})).json();["veritas","oak","strickland","calder"].forEach(f=>{var y,p;const d=document.getElementById(f);d.classList.remove("hidden"),d.classList.remove("correct","incorrect"),d.classList.add(c.correct?"correct":"incorrect");const k=((p=(y=c.professors)==null?void 0:y[f])==null?void 0:p[c.correct?"correct":"incorrect"])||"";d.querySelector(".professor-quote").innerText=k});const t=i.logical_complexity||50,s=i.expected_time_sec||20;let h=100-Math.min(100,n/s*100);h=Math.max(0,h);const O=h;v.push({x:t,y:O,correct:c.correct,category:i.category||"logic"}),N(),g=!0,m.classList.remove("hidden"),document.getElementById("next-btn").classList.remove("hidden")}function N(){b.clearRect(0,0,r.width,r.height),v.forEach(e=>{const n=new Image;n.src=w[e.category]||w.logic;const o=e.x/100*r.width-12,c=r.height-e.y/100*r.height-12;n.onload=()=>{b.drawImage(n,o,c,24,24)}})}function L(){const e=document.getElementById("login-btn"),n=document.getElementById("logout-btn"),o=document.getElementById("user-email");a?(e.style.display="none",n.style.display="inline-block",o.innerText=`Hi, ${a.email}`):(e.style.display="inline-block",n.style.display="none",o.innerText="")}async function P(){const{data:e}=await u.auth.getUser();a=e.user,L(),u.auth.onAuthStateChange((n,o)=>{a=(o==null?void 0:o.user)||null,L()})}document.getElementById("login-btn").onclick=async()=>{const{error:e}=await u.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.href}});e&&console.error("Login error:",e.message)};document.getElementById("logout-btn").onclick=async()=>{const{error:e}=await u.auth.signOut();e&&console.error("Logout error:",e.message)};document.addEventListener("DOMContentLoaded",()=>{P(),["veritas","oak","strickland","calder"].forEach(n=>{document.getElementById(n).classList.add("hidden")}),m.classList.add("hidden");const e=document.getElementById("next-btn");e.onclick=B});B();
